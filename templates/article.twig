{% extends "home.twig" %}

{% block content %}
    <!-- Page Content -->
    <section class="content">
        <div class="container">

            <div class="articles">
                <div class="header_articles">
                    <a href="http://localhost/blog/?page=article&id={{ article.id }}"><h3 class="title_header">{{ article.titre | convert_encoding('UTF-8', 'ISO-8859-1')  }}</h3></a>
                    {% if session.statut == true %}
                        <a href="http://localhost/blog/?page=delete_article&id={{ article.id }}"><i id="delete_icon" title="supprimer" class="fa fa-trash fa-lg" aria-hidden="true"></i></a>
                        <i id="modify_icon" title="editer" class="fa fa-pencil fa-lg" aria-hidden="true"></i>
                    {% endif %}
                </div>
                <div class="body_articles">
                    <p>{{ article.texte | convert_encoding('UTF-8', 'ISO-8859-1') }}</p>
                </div>
                <div class="footer_articles">
                    <p>Publi√© le {{ article.date|date("d/m/Y") }}</p>
                </div>
            </div>


            {% if session.statut != true %}

                <div class="comment_form">

                    <form action="http://localhost/blog/?page=post_comment" method=POST>
                        Titre:<input name="commentaire[0][auteur]"/>
                        texte:<input name="commentaire[0][texte]"/>
                        <input style="visibility: hidden;" value="{{ article.id }}" name="commentaire[0][id_article]">
                        <input type="submit" value="Submit">
                    </form>

                </div>


            {% else %}

                <div id="ohoh">
                    <form id="get-data-form" method="POST">
                        <textarea class="tinymce" id="texteditor"></textarea>
                        <input type="submit" value="getData">
                    </form>
                </div>

            {% endif %}



            <div class="comments-container">
                <h1>Commentaires</h1>

                <ul id="comments-list" class="comments-list">
                    {% for commentaire in commentaires %}
                    <li>
                        <div class="comment-main-level" id="commentaire_{{ commentaire.id }}">
                            <!-- Avatar -->
                            <div class="comment-avatar"><img class="user" src="web/img/user.svg"></div>
                            <!-- Commentaires -->
                            <div class="comment-box">
                                <div class="comment-head">
                                    <h6 class="comment-name">{{ commentaire.auteur | convert_encoding('UTF-8', 'ISO-8859-1') }}</h6>
                                    <span>{{ commentaire.date|date("d/m/Y") }}</span>
                                    {% if session.statut == true %}
                                        <i class="fa fa-trash-o" aria-hidden="true"></i>
                                    {% else %}
                                        <i class="fa fa-ban" id="delete_icon" aria-hidden="true"></i>
                                    {% endif %}
                                </div>
                                <div class="comment-content">
                                    {{ commentaire.texte }}
                                </div>
                            </div>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>

        </div>

    </section>

{% endblock %}



{% block script %}


    <script src="https://cloud.tinymce.com/stable/tinymce.min.js?apiKey=218h2ppq5qps0std3k5qz1z6p9lnpisfzwt2z9b2z0kum0ri"></script>



    <script type="text/javascript">

        tinymce.init({
            width: "70%",
            height: "50px",
            selector: "textarea",
            plugins: "a11ychecker, advcode, linkchecker, media mediaembed, powerpaste, tinymcespellchecker",
            toolbar: "a11ycheck, code"
        });



        window.onload = function(){

            var btn = document.getElementById('SubmitBtn');

            btn.onclick = function(){

                //This MUST alert HTML content of editor.
                alert( tinyMCE.activeEditor.getContent() );
            }
        }

    </script>

    <script>
        $(document).ready(function() {
            $("#get-data-form").submit(function(e){
                var content = tinymce.get("texteditor").getContent();
                alert(content);
            });
        });
        $.ajax({
            url: "test.html",
            context: document.body
        }).done(function() {
            $( this ).addClass( "done" );
        });
    </script>

{% endblock %}